import { Injectable } from '@nestjs/common';
import * as Xlsx from '../utils/function/XlsxFunction';
import { Cell, Row } from 'exceljs';

@Injectable()
export class XlsxService {
  async do20230520(): Promise<any> {
    const fileFolder = `C:/Users/User/AppData/Roaming/DBeaverData/workspace6/General/Scripts/results/0520/雜魚大群組總數據/`;
    const fileNameArray = [
      `大群組停車場.xlsx`,
      `大群組傳統飲食.xlsx`,
      `大群組公家單位.xlsx`,
      `大群組加油站.xlsx`,
      `大群組咖啡店.xlsx`,
      `大群組房仲類.xlsx`,
      `大群組手搖飲類.xlsx`,
      `大群組早餐店.xlsx`,
      `大群組模板.xlsx`,
      `大群組汽車保養廠.xlsx`,
      `大群組洗衣店.xlsx`,
      `大群組眼鏡類.xlsx`,
      `大群組美容店.xlsx`,
      `大群組藥妝類.xlsx`,
      `大群組藥局.xlsx`,
      `大群組補習班.xlsx`,
      `大群組賣場類.xlsx`,
      `大群組車商.xlsx`,
      `大群組速食類.xlsx`,
      `大群組醫療機構.xlsx`,
      `大群組電信類.xlsx`,
      `大群組電子用品類.xlsx`,
      `大群組鞋類.xlsx`,
    ];
    for (const fileName of fileNameArray) {
      const workbook = await Xlsx.readExcel(fileFolder + fileName);
      const worksheet1 = workbook.getWorksheet(`全桃園統計表格不含外科`);
      let cellB2 = worksheet1.getCell(`B2`);
      cellB2.value = 1163;
      let cellD17 = worksheet1.getCell(`D17`);
      cellD17.value = 1163;
      let cellE17 = worksheet1.getCell(`E17`);
      cellE17.value = 1163;

      const worksheet2 = workbook.getWorksheet(`市區不含外科`);
      cellB2 = worksheet2.getCell(`B2`);
      cellB2.value = 402;
      cellD17 = worksheet2.getCell(`D17`);
      cellD17.value = 402;
      cellE17 = worksheet2.getCell(`E17`);
      cellE17.value = 402;

      const worksheet3 = workbook.getWorksheet(`郊區不含外科`);
      cellB2 = worksheet3.getCell(`B2`);
      cellB2.value = 761;
      cellD17 = worksheet3.getCell(`D17`);
      cellD17.value = 761;
      cellE17 = worksheet3.getCell(`E17`);
      cellE17.value = 761;

      await Xlsx.writeExcelFile(workbook, fileName, {
        folderPathSrc: null,
        needTimeStamp: false,
      });
    }
    return null;
  }

  async do20230614(): Promise<any> {
    console.time(`do20230614`);
    const removeNumberList = [
      `6`,
      `60`,
      `102`,
      `137`,
      `218`,
      `261`,
      `275`,
      `298`,
      `301`,
      `436`,
      `507`,
      `518`,
      `545`,
      `552`,
      `665`,
      `682`,
      `712`,
      `732`,
      `753`,
      `795`,
      `814`,
      `819`,
      `834`,
      `847`,
      `868`,
      `898`,
      `920`,
      `940`,
      `967`,
      `971`,
      `980`,
      `1002`,
      `1068`,
      `1073`,
      `1082`,
      `1101`,
      `1124`,
      `1125`,
      `1127`,
      `1192`,
      `1235`,
      `1279`,
      `1284`,
      `1314`,
      `1325`,
      `1331`,
      `1343`,
      `1352`,
      `1372`,
      `1374`,
      `1398`,
      `1425`,
      `1444`,
      `1446`,
      `1447`,
      `1494`,
      `1495`,
      `1516`,
      `1527`,
      `1529`,
      `1556`,
      `1589`,
      `1613`,
      `1650`,
      `1702`,
      `1709`,
      `1730`,
      `1753`,
      `1764`,
      `1768`,
      `1771`,
      `1772`,
      `1780`,
      `1785`,
      `1786`,
      `1789`,
      `1793`,
      `1798`,
      `1807`,
      `1847`,
      `1876`,
      `1925`,
      `1933`,
      `1973`,
      `2028`,
      `2035`,
      `2040`,
      `2051`,
      `2088`,
      `2091`,
      `2107`,
      `2110`,
      `2151`,
      `2161`,
      `2205`,
      `2226`,
      `2292`,
      `2319`,
      `2350`,
      `2376`,
      `2444`,
      `2449`,
      `2467`,
      `2469`,
      `2559`,
      `2593`,
      `2615`,
      `2628`,
      `2675`,
      `2690`,
      `2774`,
      `2814`,
      `2824`,
      `2833`,
      `2906`,
      `2935`,
      `2945`,
      `2979`,
      `3001`,
      `3011`,
      `3040`,
      `3052`,
      `3060`,
      `3133`,
      `3137`,
      `3147`,
      `3164`,
      `3173`,
      `3234`,
      `3241`,
      `3264`,
      `3305`,
      `3363`,
      `3364`,
      `3432`,
      `3450`,
      `3471`,
      `3530`,
      `3556`,
      `3570`,
      `3572`,
      `3586`,
      `3624`,
      `3712`,
      `3751`,
      `3790`,
      `3794`,
      `3830`,
      `3854`,
      `3888`,
      `3890`,
      `3907`,
      `3972`,
      `3998`,
      `4034`,
      `4045`,
      `4070`,
      `4072`,
      `4088`,
      `4110`,
      `4116`,
      `4134`,
      `4155`,
      `4158`,
      `4174`,
      `4178`,
      `4185`,
      `4195`,
      `4213`,
      `4263`,
      `4284`,
      `4354`,
      `4363`,
      `4375`,
      `4386`,
      `4500`,
      `4542`,
      `4546`,
      `4553`,
      `4566`,
      `4574`,
      `4588`,
      `4610`,
      `4633`,
      `4635`,
      `4691`,
      `4695`,
      `4725`,
      `4729`,
      `4738`,
      `4749`,
      `4757`,
      `4775`,
      `4828`,
      `4901`,
      `4915`,
      `5034`,
      `5054`,
      `5068`,
      `5098`,
      `5121`,
      `5174`,
      `5189`,
      `5210`,
      `5233`,
      `5240`,
      `5266`,
      `5297`,
      `5306`,
      `5310`,
      `5336`,
      `5338`,
      `5349`,
      `5420`,
      `5443`,
      `5463`,
      `5518`,
      `5599`,
      `5626`,
      `5635`,
      `5647`,
      `5695`,
      `5715`,
      `5716`,
      `5758`,
      `5760`,
      `5762`,
      `5769`,
      `5808`,
      `5827`,
      `5834`,
      `5844`,
      `5845`,
      `5850`,
      `5941`,
      `5994`,
      `6044`,
      `6052`,
      `6054`,
      `6077`,
      `6080`,
      `6095`,
      `6149`,
      `6185`,
      `6199`,
      `6226`,
      `6261`,
      `6284`,
      `6327`,
      `6350`,
      `6351`,
      `6361`,
      `6374`,
      `6441`,
      `6447`,
      `6475`,
      `6478`,
      `6497`,
      `6520`,
      `6537`,
      `6540`,
      `6558`,
      `6565`,
      `6593`,
      `6596`,
      `6606`,
      `6654`,
      `6655`,
      `6736`,
      `6748`,
      `6770`,
      `6771`,
      `6826`,
      `6861`,
      `6886`,
      `6895`,
      `6902`,
      `6922`,
      `6956`,
      `6981`,
      `6986`,
      `7018`,
      `7040`,
      `7043`,
      `7086`,
      `7110`,
      `7121`,
      `7129`,
      `7196`,
      `7279`,
      `7302`,
      `7315`,
      `7317`,
      `7354`,
      `7359`,
      `7368`,
      `7414`,
      `7419`,
      `7463`,
      `7470`,
      `7505`,
      `7519`,
      `7561`,
      `7621`,
      `7751`,
      `7778`,
      `7853`,
      `7856`,
      `7859`,
      `7879`,
      `8046`,
      `8055`,
      `8096`,
      `8237`,
      `8436`,
      `8456`,
      `8477`,
      `8602`,
      `8666`,
      `8717`,
      `8724`,
      `8735`,
      `8741`,
      `8780`,
      `8811`,
      `8820`,
      `8901`,
      `9062`,
      `9130`,
      `9135`,
      `9171`,
      `9231`,
      `9245`,
      `9333`,
      `9337`,
      `9366`,
      `9394`,
    ];
    const fileFolder = `C:/Users/User/AppData/Roaming/DBeaverData/workspace6/General/Scripts/results/母檔/0614/雜魚各點/`;
    const fileNameArray = [
      `21世紀不動產.xlsx`,
      `85度c.xlsx`,
      `COMEBUY.xlsx`,
      `GOGORO.xlsx`,
      `Live互動美語.xlsx`,
      `PIZZAHOT.xlsx`,
      `Qburger.xlsx`,
      `sum優質車商聯盟.xlsx`,
      `sum汽車保修聯盟.xlsx`,
      `Teas原味.xlsx`,
      `ubike.xlsx`,
      `三顧茅廬.xlsx`,
      `中信房屋.xlsx`,
      `中華電信.xlsx`,
      `中醫診所.xlsx`,
      `五十嵐.xlsx`,
      `住商不動產.xlsx`,
      `信義房屋.xlsx`,
      `俥停日月亭宜舍.xlsx`,
      `全國電子.xlsx`,
      `全家福鞋店.xlsx`,
      `全聯.xlsx`,
      `八方雲集.xlsx`,
      `公車站.xlsx`,
      `區臣氏.xlsx`,
      `可不可熟成紅茶.xlsx`,
      `台塑石油.xlsx`,
      `台灣中油.xlsx`,
      `台灣之星.xlsx`,
      `台灣大哥大.xlsx`,
      `台灣彩券.xlsx`,
      `台灣聯通.xlsx`,
      `吉的堡美語學校.xlsx`,
      `吮指王.xlsx`,
      `嘟嘟房.xlsx`,
      `四海遊龍.xlsx`,
      `固特異.xlsx`,
      `圖書館.xlsx`,
      `城市漢寶.xlsx`,
      `大樹藥局.xlsx`,
      `太平洋房屋.xlsx`,
      `好了啦超大杯.xlsx`,
      `學校.xlsx`,
      `安養院.xlsx`,
      `家樂福.xlsx`,
      `寶島眼鏡.xlsx`,
      `寶雅.xlsx`,
      `小林眼鏡.xlsx`,
      `常春藤美語.xlsx`,
      `康氏美.xlsx`,
      `弘爺漢堡.xlsx`,
      `快洗可得.xlsx`,
      `拉亞漢寶.xlsx`,
      `摩斯漢堡.xlsx`,
      `摩曼頓.xlsx`,
      `星巴克.xlsx`,
      `普利司通.xlsx`,
      `普客二四.xlsx`,
      `杏一藥局.xlsx`,
      `東森自然美.xlsx`,
      `梁社漢.xlsx`,
      `消防分隊.xlsx`,
      `清原芋園.xlsx`,
      `清心福全.xlsx`,
      `漢堡大師.xlsx`,
      `燦坤3c.xlsx`,
      `牙醫診所.xlsx`,
      `獸醫診所.xlsx`,
      `維康.xlsx`,
      `美國戴克斯特.xlsx`,
      `美廉社.xlsx`,
      `肯德基.xlsx`,
      `胖老爹.xlsx`,
      `藥局.xlsx`,
      `西醫診所.xlsx`,
      `詩威特.xlsx`,
      `警察局.xlsx`,
      `路易莎咖啡.xlsx`,
      `運動場(不參與排序).xlsx`,
      `達美樂.xlsx`,
      `遠傳.xlsx`,
      `郵筒.xlsx`,
      `都可coco.xlsx`,
      `長頸鹿美語.xlsx`,
      `麥味登.xlsx`,
      `麥當勞.xlsx`,
    ];
    for (const fileName of fileNameArray) {
      const workbook = await Xlsx.readExcel(fileFolder + fileName);
      const worksheet = workbook.getWorksheet(`基本資料及時間`);

      worksheet.eachRow((row: Row) => {
        const values = row.values;
        const number = values[1].toString();
        if (removeNumberList.includes(number)) {
          row.eachCell((cell: any) => {
            if (!cell.value.formula && !cell.value.sharedFormula) {
              cell.value = null;
            }
          });
        }
      });

      await Xlsx.writeExcelFile(workbook, fileName, {
        folderPathSrc: `public/export/雜魚各點/`,
        needTimeStamp: false,
      });
      console.log(`fileName:${fileName} finished...`);
    }
    console.timeEnd(`do20230614`);
  }
}
